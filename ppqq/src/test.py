
from Tools import Coder;

from Tools import TEA;

from AndroidQQ import AndroidQQ;

class test():
    
    
    
    
    if __name__ == '__main__':
      
      print 111
      
      code = '3c8c40ab23bc0024d7f0ae9408004500039b40e840008006c623c0a86407716c5a35cbce1f90d7280432bea3a13c5018409962ed000000000373000000080200000004000000000d3633343534353339397a990a6f0da475adcf8c1ed97a7bd860baeaf32322c29186adf521109e60560b579d739d4f891b2e257bea15b0b67d907d388deae0e6b90492456eff361d13b7678cc800352238077f9e1f7124a7b05c252f33cc866da276441b5b2c12a6e487d910e5a51511c9df7008ccc6a51746dc1e7ab36b2deea4f8f007fe42831cb4929192d98e53dec70d03807096bb3bfd16a758465c8bfacfca72ffb2613471718a9e9bcfc1559e51d431a74eefc36f424e143d065e36ca5692f7b85674482a44832aa835703c8999a4a8b97e7b564d0e43274a4ec223ce42eaf38e5fcc68bdf2d054877e2ab27c0f78c3d23bcde79f13fe5c4cad1e6b16ab4352c106ea384e06e9cb185bdeeec36f1ad271cd6e9e65a4c30a424f22ab892430d89c7ff9c461f7e5e721d0391ed1796a2a047eca9e895b50de787e3e1173a98977a4b7581015e21b71d98ec9fbf69157965473150a50222b6d21bff57e2269eaff9eb336563629f99c906dcd1f23aef8ada277bee00c979209e43d6c3404ab9ba41c7c769e37c435441c3adff0359e17d966782adc4105424712d7f03c7906deb73b9e71fb960105c5faf233647291dcaf00f97562b7f300fe77cdac08d81b8137c817491306a95430045488f064b7a219a60c768bf83e3fdc5f26d8f8c8e997f22c166026fec63707706c9a111e5317f138fa22eb3d8dcba6731f0fac3e0ef73a63d9481752feefe3db2c72f57d048804e70f40f9b93108d7a233d81d1de5d175f2392566e18a0263fd20e1f05e31c21b67678afd6f2c9ff0953c83020fe3feb2213f2e496ad17b3d24485ae6abadead85e31704dc9c1ce6aefbd7b2ed1d5e17b786fd8cd37e164eacea9ec60c6f6fa1c5965ffefe8f69148e60c27ce772551157fba9d46c87df59d87fb8f4d383184f52aaa911eed8fd8750e87e221aa18642fd5856376aeb5adbd45b1bf589ef143f44ca5781b82ec5d7ddd3aaae2b1d5c962ec2835bb6599ba1f3d16271ccc262cf0d20e65b1a8741f7fbdca64317759b232ba3a8fc820d3449be7e008609e7dee817df72604c7f20139a2e762f2799fce00bf81f3832de40415ec4c0f90e4af0df5cda6a456b15bee7ce3689688abaf427568fa9551a19eb542ad1e01ba4bed153809bc59c869438f7c09bf124f2aa9b06610bf5f4319bcd05eefe3079c1a1eb38bed8e096e1bea6ee8a1075c6ca3c2f9';
      
      #print Coder.hexstr2str(code);  
       
        
     # print code.encode('hex');
     
     
    print 8 << 4
    
    print Coder.num2hexstr(len(Coder.str2hexstr('634545399'))/2+4, 4)
    
    
    print Coder.str2hexstr('634545399')
    
    qq = AndroidQQ('634545399','xiaomin0322####');
    
    packet = qq.packSendLoginMessage();
    
    print Coder.num2hexstr(len(packet)/2+4, 4);
    
    print len(packet);
    
    
   # ss = '7a215d1c28d0681072f3370142669487fee6b5a222b18751a1a4ce6da0b952253994e847c9e1399a945be54facbd25d5f0d25b8325114dbfc40c2c5c48db42e9fb02e8c566529f7705d7fdf8958b2de7944f5fcfab050838d4809c83b5ab657cf4a4c2042129169059f8053e6f0cd5f0b5ed75dee694a70b236b6d040055bc336ebf678a520911be00e057435ac6c0b21f40718338e696133bc7df52d51632053484b5e53a8a82fde7b148fe5f91bc546d92b1a24f48db2863f7741df7881085a78f75f9b7912c57ccff62bddaa821e4e41dd08ca6c995a5c766b5763c8afcfc96feb80944017eb95e87b0e2f1b156aeb86c0c38d2521a8e9a7cac7ab4184c5d1f89b43dc16e9d24aed14a9f798a974a9ad6555f41ee65d1f5094a8b845140ecfbe01774d0a6ac2a3af893b7a60bdae2d92285bddd0b2162501bc726fbb169abc3c0388e49584f2839225cd5748a8cea428cb89d9f8b36fbacbfdfbbcf2c331d6e548a21c3490a29a20b904f6bf3766042ce90c45376830ce23ca65b261ed79d08722b02aa9d0f3589671efa5860db35fa7e352c765747cfad6ee9ee908dc3b49b9995120c6fe70667250ee615d64004dd20951a274fa7a635262b509db37e1e1115d269c2b90af5da75530e5bba7573798355f6e2839a1fb71c3adf4bf361df606180b71d81bc6faa1132478c0da88475ed835cdda5626142163fb3cf1009730cf18a560fc6c072f84f1e860ed2fed6d58a5befdee5f1579bd978057cdaa59b83940256b9b109984fe16b624338869ed8d01d7e969054abe7f8ae6efc2ba8cf88be35158380f2638bc1c1d86b33f73850d1a3631f5c74aedba7908ac8989729619f192a67809734a21c274c3469384ba209baa1fb60a7e48bc823383ee7a667532e59799b807bb862935e0e72900be302b8f14ada32e30dcb06773db42ea695ae0fdba8440b40c63963452733a9a4fb745df6d29e8a1f7a0c806b2e64f53bac94b7bb6791a36006126f28d1cb975c8253e8148069e4d460cbf3d018b75baebbc9b8ff052cb62c2e39b30d6111f0aca0cb56a852797d1eeefe243168bc87f5b5b574109198c626c64cde9a59d5be65c2f87708de9118b5e272176ec6f7b9bcb030aea0e3a498648aad32d7ddf16e74d9145ee9afab1e29a67012984eb144ae2fa5743bd2b6b209ccef89975d51d122794bd7700df174c5bd'
    
    #print TEA.detea_hexstr(ss,'00'*16)
    
    
    ss='7a215d1c28d0681072f3370142669487fee6b5a222b18751a1a4ce6da0b952253994e847c9e1399a945be54facbd25d5f0d25b8325114dbfc40c2c5c48db42e9fb02e8c566529f7705d7fdf8958b2de7944f5fcfab050838d4809c83b5ab657cf4a4c2042129169059f8053e6f0cd5f0b5ed75dee694a70b236b6d040055bc336ebf678a520911be00e057435ac6c0b21f40718338e696133bc7df52d51632053484b5e53a8a82fde7b148fe5f91bc546d92b1a24f48db2863f7741df7881085a78f75f9b7912c57ccff62bddaa821e4e41dd08ca6c995a5c766b5763c8afcfc96feb80944017eb95e87b0e2f1b156aeb86c0c38d2521a8e9a7cac7ab4184c5d1f89b43dc16e9d24aed14a9f798a974a9ad6555f41ee65d1f5094a8b845140ecfbe01774d0a6ac2a3af893b7a60bdae2d92285bddd0b2162501bc726fbb169abc3c0388e49584f2839225cd5748a8cea428cb89d9f8b36fbacbfdfbbcf2c331d6e548a21c3490a29a20b904f6bf3766042ce90c45376830ce23ca65b261ed79d08722b02aa9d0f3589671efa5860db35fa7e352c765747cfad6ee9ee908dc3b49b9995120c6fe70667250ee615d64004dd20951a274fa7a635262b509db37e1e1115d269c2b90af5da75530e5bba7573798355f6e2839a1fb71c3adf4bf361df606180b71d81bc6faa1132478c0da88475ed835cdda5626142163fb3cf1009730cf18a560fc6c072f84f1e860ed2fed6d58a5befdee5f1579bd978057cdaa59b83940256b9b109984fe16b624338869ed8d01d7e969054abe7f8ae6efc2ba8cf88be35158380f2638bc1c1d86b33f73850d1a3631f5c74aedba7908ac8989729619f192a67809734a21c274c3469384ba209baa1fb60a7e48bc823383ee7a667532e59799b807bb862935e0e72900be302b8f14ada32e30dcb06773db42ea695ae0fdba8440b40c63963452733a9a4fb745df6d29e8a1f7a0c806b2e64f53bac94b7bb6791a36006126f28d1cb975c8253e8148069e4d460cbf3d018b75baebbc9b8ff052cb62c2e39b30d6111f0aca0cb56a852797d1eeefe243168bc87f5b5b574109198c626c64cde9a59d5be65c2f87708de9118b5e272176ec6f7b9bcb030aea0e3a498648aad32d7ddf16e74d9145ee9afab1e29a67012984eb144ae2fa5743bd2b6b209ccef89975d51d122794bd7700df174c5bd'
    
    ss='7a990a6f0da475adcf8c1ed97a7bd860baeaf32322c29186adf521109e60560b579d739d4f891b2e257bea15b0b67d907d388deae0e6b90492456eff361d13b7678cc800352238077f9e1f7124a7b05c252f33cc866da276441b5b2c12a6e487d910e5a51511c9df7008ccc6a51746dc1e7ab36b2deea4f8f007fe42831cb4929192d98e53dec70d03807096bb3bfd16a758465c8bfacfca72ffb2613471718a9e9bcfc1559e51d431a74eefc36f424e143d065e36ca5692f7b85674482a44832aa835703c8999a4a8b97e7b564d0e43274a4ec223ce42eaf38e5fcc68bdf2d054877e2ab27c0f78c3d23bcde79f13fe5c4cad1e6b16ab4352c106ea384e06e9cb185bdeeec36f1ad271cd6e9e65a4c30a424f22ab892430d89c7ff9c461f7e5e721d0391ed1796a2a047eca9e895b50de787e3e1173a98977a4b7581015e21b71d98ec9fbf69157965473150a50222b6d21bff57e2269eaff9eb336563629f99c906dcd1f23aef8ada277bee00c979209e43d6c3404ab9ba41c7c769e37c435441c3adff0359e17d966782adc4105424712d7f03c7906deb73b9e71fb960105c5faf233647291dcaf00f97562b7f300fe77cdac08d81b8137c817491306a95430045488f064b7a219a60c768bf83e3fdc5f26d8f8c8e997f22c166026fec63707706c9a111e5317f138fa22eb3d8dcba6731f0fac3e0ef73a63d9481752feefe3db2c72f57d048804e70f40f9b93108d7a233d81d1de5d175f2392566e18a0263fd20e1f05e31c21b67678afd6f2c9ff0953c83020fe3feb2213f2e496ad17b3d24485ae6abadead85e31704dc9c1ce6aefbd7b2ed1d5e17b786fd8cd37e164eacea9ec60c6f6fa1c5965ffefe8f69148e60c27ce772551157fba9d46c87df59d87fb8f4d383184f52aaa911eed8fd8750e87e221aa18642fd5856376aeb5adbd45b1bf589ef143f44ca5781b82ec5d7ddd3aaae2b1d5c962ec2835bb6599ba1f3d16271ccc262cf0d20e65b1a8741f7fbdca64317759b232ba3a8fc820d3449be7e008609e7dee817df72604c7f20139a2e762f2799fce00bf81f3832de40415ec4c0f90e4af0df5cda6a456b15bee7ce3689688abaf427568fa9551a19eb542ad1e01ba4bed153809bc59c869438f7c09bf124f2aa9b06610bf5f4319bcd05eefe3079c1a1eb38bed8e096e1bea6ee8a1075c6ca3c2f9'
    
    ss='ccc79e9e621d4711e6fd7fb2f48bd0d580f30ba0f1ca66424a62e1894859c39093c77a21b36f5f6e0ba1353aa975cdb65ad87c0b22d6e2836a8a07726be7fba505fb15b63fed01647f4dae4776ce3b2f63297205087a8d307d396eb37a2d84fe39dc7ec52c34a48e53b6914a44da78d34faed5dd40f791aceebf12405844908f1ca56a0f6b8ab316622f8094f198956d50b1c5c56e27c32b133c5e4a788b3d0d3c7260fa667567fb37b9b602723e8b67ed0435768c7a9f1dfb048205f6a0dbaee05b556f0ce2721a9294693ac1b1b41123942241783e9d6ee609255ba88de4bc0990240ddc66f61edbbfbd35c1de43a31c45d31c39e2df4ce4e4a56e25f3725c842df206ed14c2f3a7bcb7cd50bf76017678b1c7cdce2abfcda17c23d35c66be28e3b213675455e9362b3f2874a69cc48a4e0c7dc99b3ab44beb180396abfc8f579246126f13a85ba2f2afaa10aa5fe9a64f54273ba1f514ba73b92d52ffa6c4a3425eb7224eee783bfb61832f81e3e4b75341f000dc9d88402de906ef33568f150b0e8eb22823f7fb4bd53df23f8e10e283b92d1794bfbf6a6f8f6d81cab1f933720e592f30a26266c034dc7e8a2d544bc5f6e4a51083cc8c8b223989acab9f49d9ba384feb254edb14fb848e4050494b1f4c579f7ad40d8c6103b3ee2eb4754885f7f20b04d5bf38d8c58dd4368689fee48292353dacf1061e6f289278d9dbd800eef79ca27d786421d56ea4e19ed1d4505c28b3e577073782b387ff8158c17fbc5626696ffbe598ac0a695d3b8d6ce626c38f4335cc60d9a77c09d73a347543624a8bafeec8d1c235007360ff87829eb337a310a489e1bf784d19d3bee96082593ddadb45c309c2da2ea86e50a1e27ef6c78d6b8130b1814cb0706136a1b1eeefbfe70ed7d61e5e11044a781157f335698dd58f75d3358ca4323acee8d79986b6a4e0e4e894fd61edef1053412ebcfad17b51ef9edc78a55f06e50391e8a045646fed6fd538be9fdd36a96b271323002d0f8d4783b18e45d23f612033b9fe73416cefd2fe602ac83e91beff93a5b821afe699f2eab6f74f82b2e25dd12135a3e34ee965d4cd1c38a2a80fe17505c81d40bc8457b98af29b48a1c65ea2b3a2d93f2c35151e1a5d3bc4ff8672ea8fd864d2bfdc43bd843d7db370f6c763fcc098ef2650ea19b34c740c9aa50ad3ad275b5b35c600e735ef'
    
    
    ss='ccc79e9e621d4711e6fd7fb2f48bd0d580f30ba0f1ca66424a62e1894859c39093c77a21b36f5f6e0ba1353aa975cdb65ad87c0b22d6e2836a8a07726be7fba505fb15b63fed01647f4dae4776ce3b2f63297205087a8d307d396eb37a2d84fe39dc7ec52c34a48e53b6914a44da78d34faed5dd40f791aceebf12405844908f1ca56a0f6b8ab316622f8094f198956d50b1c5c56e27c32b133c5e4a788b3d0d3c7260fa667567fb37b9b602723e8b67ed0435768c7a9f1dfb048205f6a0dbaee05b556f0ce2721a9294693ac1b1b41123942241783e9d6ee609255ba88de4bc0990240ddc66f61edbbfbd35c1de43a31c45d31c39e2df4ce4e4a56e25f3725c842df206ed14c2f3a7bcb7cd50bf76017678b1c7cdce2abfcda17c23d35c66be28e3b213675455e9362b3f2874a69cc48a4e0c7dc99b3ab44beb180396abfc8f579246126f13a85ba2f2afaa10aa5fe9a64f54273ba1f514ba73b92d52ffa6c4a3425eb7224eee783bfb61832f81e3e4b75341f000dc9d88402de906ef33568f150b0e8eb22823f7fb4bd53df23f8e10e283b92d1794bfbf6a6f8f6d81cab1f933720e592f30a26266c034dc7e8a2d544bc5f6e4a51083cc8c8b223989acab9f49d9ba384feb254edb14fb848e4050494b1f4c579f7ad40d8c6103b3ee2eb4754885f7f20b04d5bf38d8c58dd4368689fee48292353dacf1061e6f289278d9dbd800eef79ca27d786421d56ea4e19ed1d4505c28b3e577073782b387ff8158c17fbc5626696ffbe598ac0a695d3b8d6ce626c38f4335cc60d9a77c09d73a347543624a8bafeec8d1c235007360ff87829eb337a310a489e1bf784d19d3bee96082593ddadb45c309c2da2ea86e50a1e27ef6c78d6b8130b1814cb0706136a1b1eeefbfe70ed7d61e5e11044a781157f335698dd58f75d3358ca4323acee8d79986b6a4e0e4e894fd61edef1053412ebcfad17b51ef9edc78a55f06e50391e8a045646fed6fd538be9fdd36a96b271323002d0f8d4783b18e45d23f612033b9fe73416cefd2fe602ac83e91beff93a5b821afe699f2eab6f74f82b2e25dd12135a3e34ee965d4cd1c38a2a80fe17505c81d40bc8457b98af29b48a1c65ea2b3a2d93f2c35151e1a5d3bc4ff8672ea8fd864d2bfdc43bd843d7db370f6c763fcc098ef2650ea19b34c740c9aa50ad3ad275b5b35c600e735ef'
    
    packSendLoginMessage =  TEA.detea_hexstr(ss,'00'*16)
    
    print packSendLoginMessage
    
    print packSendLoginMessage.find('919260a4e19d44a59b5932b8790fc37d')
    
    
    
    #1
    #print Coder.num2hexstr(qq.seq+1, 4)
    
    
  
    
    #packSendLoginTlv = TEA.detea_hexstr(packSendLoginMessage[224+144-1: 224+340-1],'00'*16)
    
#print 'packSendLoginTlv :' +  packSendLoginTlv
    
    
#print 'tgtKey :' + packSendLoginTlv[108+102 : 108+134]

tlv106Val= '00034c2e14340000000500000010000000000000000025d264f75804ab1c00000000011fec8fe0fd191afd4a31742cf9211b678aa66a4f50d8db42855c7e14af9cf018000000000138363431313631393537393739323220029f54000000010000'
    
print tlv106Val.find('8aa66a4f50d8db42855c7e14af9cf018')   
       
print 'tgtKey' + tlv106Val[102:134]     
   
   
   
   

    
   
   
   
   
   
